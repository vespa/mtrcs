var chainer=function(e,t){var i=e[0](t);return e.shift(),e.length>0&&"_stopChain"!==t&&chainer(e,i),i},addEvents=function(e,t,i){return t.constructor===String?e.addEventListener(t,function(e){i(e)}):t.map(function(t){e.addEventListener(t,function(e){i(e)})})},windowMonitor=function(e,t,i){var n=function(){return{width:e.document.documentElement.clientWidth,height:e.document.documentElement.clientHeight,viewable:document.hasFocus(),scrollX:e.pageXOffset,scrollY:e.pageYOffset}};return i(e,["focus","blur","load","visibilitychange"],function(){document.body.focus(),setTimeout(function(){n()})}),i(document,["click","mouseover"],function(){setTimeout(function(){n()},30)}),{status:function(e){return void 0===e?n():n()[e]}}}(window,0,addEvents),adMonitor=function(e,t,i,n){"use strict";var r=[],o=[],c=function(){return r},a=function(t){return t.map(function(t){var i=function(i){return Number(e.getComputedStyle(t,null).getPropertyValue(i).replace(/px/,""))};return{target:t,identifier:t.id||t.className,adIsViewable:!1,area:i("height")*i("width"),width:i("width"),height:i("height"),visibleHorizontal:0,visibleVertical:0,visibleArea:0,percentageVisibleHorizontal:0,percentageVisibleVertical:0,percentageVisibleArea:0,clicks:0}})},l=function(){var e=[].slice.call(arguments),t=r.concat(e).sort();return r=t.filter(function(e,i){return t[i-1]!==e}),l},u=function(t){return t.map(function(t){return i(t.target,["click","touch"],function(i){i.preventDefault(),t.clicks=t.clicks+1,e.getSelection().removeAllRanges(),console.log("CLICK ON "+t.identifier+": "+t.clicks)}),t})},s=function(e){var t=[];e.map(function(e){return[].slice.call(document.querySelectorAll(e))}).filter(function(e){return e.length>0}).map(function(e){return t=t.concat(e),e});return t},d=function(e,t){return t<=0?0:Math.floor(t/e*100)},f=function(e){return function(t){var i,n,r,o,c,a,l,u,s,f,g=t.target.getBoundingClientRect(),h=(e.status("scrollX"),e.status("scrollY"),e.status("width")),p=e.status("height"),b=(a=p,l=t,u=l.target.getBoundingClientRect(),s=u.height,f=u.top+u.height,u.bottom<u.height&&(s=u.bottom),a<f&&(s-=f-a),s<=0?0:s).toFixed(2),v=(i=h,n=t,r=n.target.getBoundingClientRect(),o=r.width,c=r.left+r.width,r.right<r.width&&(o=r.right),i<c&&(o-=c-i),o<=0?0:o).toFixed(2),m=b*v,w=d(g.height,b),V=d(g.width,v),x=d(g.height*g.width,m);return 0!==b&&0!==v||(v=b=w=V=0),t.visibleVertical=b,t.visibleHorizontal=v,t.visibleArea=m,t.percentageVisibleVertical=w+"%",t.percentageVisibleHorizontal=V+"%",t.percentageVisibleArea=x+"%",t.adIsViewable=x>0,t}},g=function(e){o=e};return i(e,"load",function(){var r;t([c,s,a,u,(r=n,function(t){return t.map(function(t){return f(r)(t),i(e,["scroll","resize","blur","focus","visibilitychange"],function(){return f(r)(t)}),t})}),g])}),{add:l,getAds:function(){return o}}}(window,chainer,addEvents,windowMonitor),reports=function(e,t,i,n,r){var o,c,a=0,l=function(){setInterval(function(){a+=1},1e3)},u=function(){c=document.createElement("div");var e=document.createElement("div");c.setAttribute("style","position:fixed;bottom:0;width:100%; text-align; pointer-events: none;"),e.setAttribute("style","border:1px solid #ccc; width: 200px; float:right;margin:12px; background-color:#fff;opacity:.9; padding:6px;font-family:arial;font-size:12px"),document.body.appendChild(c),o=e},s=function(e){return{Identifier:e.identifier,"Ad is viewable":e.adIsViewable,"Active User":n.status("viewable"),"Viewability time of the ad in sec":a,Area:e.area+"px²",Width:e.width+"px",Height:e.height+"px","Total visible area":e.visibleArea+"px²","Visible Horizontal":e.visibleHorizontal+"px","Visible vertical":e.visibleVertical+"px","Percentage VisibleArea":e.percentageVisibleArea,"Percentage Visible Horizontal":e.percentageVisibleHorizontal,"Percentage Visible Vertical":e.percentageVisibleVertical,Clicks:e.clicks}},d=function(e){var t=document.createElement("div"),i=document.createElement("span");return t.setAttribute("style","padding:2px 0; border-bottom:1px dotted #ccc"),c.innerHTML="",e.map(function(e){var n=o.cloneNode(),r=s(e);Object.keys(r).map(function(e){var o=t.cloneNode(),c=r[e];if(c.constructor===Boolean){var a=i.cloneNode();a.style.color=c?"#0a0":"#c00",a.innerHTML=c.toString(),c=a.outerHTML}o.innerHTML=e+"<b>: "+c+"</b>",n.appendChild(o)}),c.appendChild(n)}),e},f=function(e){return e.map(function(e){var t="",i=s(e);return Object.keys(i).map(function(e){t+=e+": "+i[e]+"\n"}),console.log(t),e})},g=function(){setInterval(function(){r([i.getAds,d,f]);i.getAds()},500)};return addEvents(e,"load",function(){r([l,u,g])}),{}}(window,0,adMonitor,windowMonitor,chainer);